<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
  <meta charset="UTF-8">
  <title>κ²€μƒ‰ κ²°κ³Ό</title>
</head>
<body>
<main layout:fragment="content" class="search-result-container">

    <div class="main-content">
      <div class="search-container">
        <form id="searchForm" th:action="@{/search}" method="get">
          <input type="text" id="search-input" name="contentName" placeholder="μ›ν•λ” μμ•…,μν™”,λ„μ„λ¥Ό μ°Ύμ•„λ³΄μ„Έμ”!">
          <button type="submit">κ²€μƒ‰</button>
        </form>
      </div>

      <br>

      <!-- μΉ΄ν…κ³ λ¦¬ λ©”λ‰΄ -->
      <div class="menu">
        <button onclick="showCategory('movie')">π¬ μν™”</button>
        <button onclick="showCategory('music')">π§ μμ•…</button>
        <button onclick="showCategory('book')">π“ λ„μ„</button>
      </div>

  <!-- contentName μ΄ λΉ„μ—μ„ λ• -->
  <h4 th:if="${#strings.isEmpty(contentName)}">μ „μ²΄ κ²€μƒ‰κ²°κ³Όμ…λ‹λ‹¤.</h4>

  <!-- contentName μ΄ μμ„ λ• -->
  <h4 th:unless="${#strings.isEmpty(contentName)}">
    "<span th:text="${contentName}"></span>" μ— λ€ν• κ²€μƒ‰κ²°κ³Όμ…λ‹λ‹¤.
  </h4>

      <!--  λ¨λ‹¬μ°½html-->
      <div id="modals-container"></div>

  <!-- μν™” -->
  <div class="category" id="movie">
    <div id = movieGenre>
      λ™ν™”
      λΌμ΄νΈλ…Έλ²¨
      λ¬΄ν‘μ†μ„¤
      μν•„
      μ¤λ¦΄λ¬
      μ‹μ§‘
      μ¶”λ¦¬μ†μ„¤
      ννƒ€μ§€μ†μ„¤
      ν”„λ΅κ·Έλλ°
      μΈλ¬Έν•™
      μ‹¬λ¦¬ν•™
      μ² ν•™
      λ¬Έν™”μΈλ¥ν•™
      μΆ…κµν•™
      ν•κµ­μ†μ„¤
      μ™Έκµ­μ†μ„¤
      κ³ μ „λ¬Έν•™
      ν„λ€λ¬Έν•™
      μ‚¬νν•™

    </div>
<!--    <h3><span class="highlight">μν™”</span> κ²€μƒ‰ κ²°κ³Ό</h3>  -->
    <div th:if="${movie.size() > 0}" class="card-container">
      <div th:each="m : ${movie}" class="card-music">
        <button type="button"
                class="details-btn"
                data-type="movies"
                th:attr="data-id=${m.id}">
          <img th:src="${m.thumbnail}" alt="μν™” μΈλ„¤μΌ" class="card-thumbnail"/>
        </button>
      </div>
    </div><br><br><br><br>
    <div th:if="${movie.size() == 0}"><h4>κ²€μƒ‰ μλ£κ°€ μ—†μµλ‹λ‹¤.</h4></div>
  </div>
<!--      &lt;!&ndash; μν™” λ¨λ‹¬ &ndash;&gt;-->
<!--      <div class = "detailMovieModal" id="movieDetailModal" onclick="if(event.target===this){closeMovieModal()}">-->
<!--        <div class="search-modal-content">-->
<!--          <img id="movieBg" class="modal-bg" src="" alt="λ°°κ²½"/>-->
<!--          <div class="modal-info">-->
<!--            <span class="modal-close" onclick="closeMovieModal()">Γ—</span>-->
<!--            <h1 id="movieTitle" class="modal-title"></h1>-->
<!--            <ul class="modal-badges">-->
<!--              <li id="movieYear"></li>-->
<!--              &lt;!&ndash;          <li id="modalGenre">μ¥λ¥΄</li>&ndash;&gt;-->
<!--            </ul>-->
<!--            <p id="movieSummary" class="modal-summary"></p>-->
<!--            <button id="modalSearchMovieBtn" onclick="showMovieTrailer(document.getElementById('movieTitle').innerText)">μκ³ νΈ λ³΄κΈ°</button>-->
<!--            <button id="modalBuyMovieBtn" onclick="youtubeMovie(document.getElementById('movieTitle').innerText)">μν™” λ³΄λ¬κ°€κΈ°</button>-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->

<!--      &lt;!&ndash; μν™” μκ³ νΈ μ νλΈ iframe &ndash;&gt;-->
<!--      <div id="trailerMovieModal" class="trailer-modal" style="display:none;" onclick="handleModalBackgroundClick(event)">-->
<!--        <div class="trailer-modal-content">-->
<!--          <span class="trailer-modal-close" onclick="closeTrailerModal('trailerMovieModal', 'trailerMovieIframe')">Γ—</span>-->
<!--          <iframe id = "trailerMovieIframe" class="trailerIframe" width="1280" height="720" frameborder="0"-->
<!--                  allow="autoplay; encrypted-media" allowfullscreen></iframe>-->
<!--        </div>-->
<!--      </div>-->

  <!-- μμ•… -->
  <div class="category" id="music">
    λ°λΌλ“
    λ„μ¤
    ν™ν•©
    R&B
    μΈλ””μμ•…
    λ΅/λ©”νƒ
    νΈλ΅νΈ
    ν¬ν¬/λΈ”λ£¨μ¤

    <!--    <h3><span class="highlight">μμ•…</span> κ²€μƒ‰ κ²°κ³Ό</h3>-->

    <div th:if="${music.size() > 0}" class="card-container">
      <div th:each="m : ${music}" class="card-music">
        <button type="button"
                class="details-btn"
                data-type="musics"
                th:attr="data-id=${m.id}">
          <img th:src="${m.thumbnail}" alt="μμ•… μΈλ„¤μΌ" class="card-thumbnail"/>
        </button>
      </div>
    </div><br><br><br><br>
    <div th:if="${music.size() == 0}"><h4>κ²€μƒ‰ μλ£κ°€ μ—†μµλ‹λ‹¤.</h4></div>
  </div>
      <!-- μμ•… λ¨λ‹¬ -->
<!--      <div class = "detailMusicModal" id="musicDetailModal" onclick="if(event.target===this){closeMusicModal()}">-->
<!--        <div class="search-modal-content">-->
<!--          <img id="musicBg" class="modal-bg" src="" alt="λ°°κ²½"/>-->
<!--          <div class="modal-info">-->
<!--            <span class="modal-close" onclick="closeMusicModal()">Γ—</span>-->
<!--            <h1 id="musicTitle" class="modal-title"></h1>-->
<!--            <ul class="modal-badges">-->
<!--              <li id="musicYear"></li>-->
<!--              <li id="singer"></li>-->
<!--              &lt;!&ndash;          <li id="modalGenre">μ¥λ¥΄</li>&ndash;&gt;-->
<!--            </ul>-->
<!--            <h5><p id="musicDes"></p></h5>-->
<!--            <p id="musicSummary" class="modal-summary"></p>-->
<!--            <button id="modalSearchMusicBtn" onclick="showMusicTrailer(document.getElementById('musicTitle').innerText)">λ®¤μ§λΉ„λ””μ¤ λ³΄κΈ°</button>-->

<!--          </div>-->
<!--        </div>-->
<!--      </div>-->

<!--      &lt;!&ndash; μμ•… κ°μƒ μ νλΈ iframe &ndash;&gt;-->
<!--      <div id="trailerMusicModal" class="trailer-modal" style="display:none;" onclick="handleModalBackgroundClick(event)">-->
<!--        <div class="trailer-modal-content">-->
<!--          <span class="trailer-modal-close" onclick="closeTrailerModal('trailerMusicModal', 'trailerMusicIframe')">Γ—</span>-->
<!--          <iframe id = "trailerMusicIframe" class="trailerIframe" width="1280" height="720" frameborder="0"-->
<!--                  allow="autoplay; encrypted-media" allowfullscreen></iframe>-->
<!--        </div>-->
<!--      </div>-->


  <!-- λ„μ„ -->
  <div class="category" id="book">
    λ™ν™”
    λΌμ΄νΈλ…Έλ²¨
    λ¬΄ν‘μ†μ„¤
    μν•„
    μ¤λ¦΄λ¬
    μ‹μ§‘
    μ¶”λ¦¬μ†μ„¤
    ννƒ€μ§€μ†μ„¤
    ν”„λ΅κ·Έλλ°
    μΈλ¬Έν•™
    μ‹¬λ¦¬ν•™
    μ² ν•™
    λ¬Έν™”μΈλ¥ν•™
    μΆ…κµν•™
    ν•κµ­μ†μ„¤
    μ™Έκµ­μ†μ„¤
    κ³ μ „λ¬Έν•™
    ν„λ€λ¬Έν•™
    μ‚¬νν•™


    <div th:if="${book.size() > 0}" class="card-container">
      <div th:each="b : ${book}" class="card-book">
        <button type="button"
                class="details-btn"
                data-type="books"
                th:attr="data-id=${b.isbn}">
          <img th:src="${b.image}" alt="λ„μ„ μΈλ„¤μΌ" class="card-thumbnail modal-bg.book"/>
        </button>
      </div>
    </div><br><br><br><br>
    <div th:if="${music.size() == 0}"><h4>κ²€μƒ‰ μλ£κ°€ μ—†μµλ‹λ‹¤.</h4></div>
  </div>

      <!-- λ„μ„ λ¨λ‹¬ -->

<!--      <div class = "detailBookModal" id="bookDetailModal" onclick="if(event.target===this){closeBookModal()}">-->
<!--        <div class="search-modal-content">-->
<!--          <img id="bookBg" class="modal-bg" src="" alt="λ°°κ²½"/>-->
<!--          <div class="modal-info">-->
<!--            <span class="modal-close" onclick="closeBookModal()">Γ—</span>-->
<!--            <h1 id="bookTitle" class="modal-title"></h1>-->
<!--            <ul class="modal-badges">-->
<!--              <li id="bookYear"></li>-->
<!--              &lt;!&ndash;          <li id="modalGenre">μ¥λ¥΄</li>&ndash;&gt;-->
<!--            </ul>-->
<!--            <h5><p id="bookDes"></p></h5>-->
<!--            <p id="bookSummary" class="modal-summary"></p>-->
<!--                    <button id="modalSearchBtn" class="modal-play" disabled>λ„μ„ κµ¬λ§¤ν•κΈ°</button>-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->

<!--    </div>-->

</main>
</body>
</html>

<script>


  // λ¨λ‹¬μ°½ html λ¶λ¬μ¤κΈ°
  fetch('/html/modals.html')
  .then(response => response.text())
  .then(data => {
    document.getElementById('modals-container').innerHTML = data;
  });

  /* μΉ΄ν…κ³ λ¦¬ ν† κΈ€ */
  function showCategory(id) {
    document.querySelectorAll('.category').forEach(c => c.style.display = 'none');
    document.getElementById(id).style.display = 'block';
  }

  document.addEventListener('DOMContentLoaded', () => showCategory('movie'));
  //
  // function showDetailModalMovie(title, releaseDate, summary, thumbnail) {
  //   /* ===== μ λ© ===== */
  //   document.getElementById('movieTitle').textContent = title;
  //   /* ===== μ—°λ„ ===== */
  //   document.getElementById('movieYear').textContent = releaseDate.split('-')[0] || releaseDate;
  //   /* ===== μν™” λ‚΄μ© ===== */
  //   document.getElementById('movieSummary').innerHTML = summary;
  //   /* ===== μΈλ„¤μΌ ===== */
  //   const img = document.getElementById('movieBg');
  //   img.src = thumbnail;
  //
  //   /* ===== λ¨λ‹¬ ν‘μ‹ ===== */
  //   document.getElementById('movieDetailModal').classList.add('active');
  //
  // }
  //
  // function youtubeMovie(title) {
  //   fetch(`/api/trailer/movie?title=${encodeURIComponent(title)}`)
  //   .then(res => res.json())
  //   .then(data => {
  //     if (data.movieVideoId) {
  //       const videoUrl = `https://www.youtube.com/watch?v=${data.movieVideoId}`;
  //       window.open(videoUrl, '_blank');
  //     } else {
  //       alert('μν™”λ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤.');
  //     }
  //   })
  //   .catch(() => alert('μν™”λ¥Ό λ¶λ¬μ¤λ” μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.'));
  // }
  //
  // function showDetailModalMusic(title, releaseDate, summary, thumbnail, type, singer) {
  //   /* ===== μ λ©Β·μ—°λ„ ===== */
  //   document.getElementById('musicTitle').textContent = title;
  //   document.getElementById('musicYear').textContent =
  //       releaseDate.split('-')[0] || releaseDate;
  //   document.getElementById("musicDes").textContent = "κ°€μ‚¬";
  //   document.getElementById("singer").textContent = singer;
  //
  //   /* ===== κ°€μ‚¬Β·μ¤„λ°”κΏ μ²λ¦¬ ===== */
  //   const processedSummary = summary
  //   .replace(/\n/g, '<br>')      // μ¤„λ°”κΏ β†’ <br>
  //   .replace(/\[/g, '<br><br>[') // [ μ•μ— <br><br>
  //   .replace(/\]/g, ']<br>');    // ] λ’¤μ— <br>
  //   document.getElementById('musicSummary').innerHTML = processedSummary;
  //
  //   /* ===== μΈλ„¤μΌ ===== */
  //   const img = document.getElementById('musicBg');
  //   img.src = thumbnail;
  //
  //   /* ===== λ¨λ‹¬ ν‘μ‹ ===== */
  //   document.getElementById('musicDetailModal').classList.add('active');
  //
  //   // const searchBtn = document.getElementById('modalSearchMusicBtn');
  //   //
  //   // // μμ•… κµ¬λ§¤ λ²„νΌ
  //   // searchBtn.textContent = 'μμ•… κµ¬λ§¤ν•κΈ° μ‚¬μ΄νΈ β';
  //   //
  //   // // ν™μ„±ν™” + ν΄λ¦­ μ΄λ²¤νΈ
  //   // searchBtn.disabled = false;
  //   // searchBtn.onclick = () => {
  //   //   const query = encodeURIComponent(title);
  //   //   window.open(`https://www.youtube.com/search?q=${query}`, '_blank');
  //   // };
  // }
  //
  // function showDetailModalBook(title, releaseDate, summary, thumbnail, type) {
  //   /* ===== μ λ©Β·μ—°λ„ ===== */
  //   document.getElementById('bookTitle').textContent = title;
  //   document.getElementById('bookYear').textContent =
  //       releaseDate.split('-')[0] || releaseDate;
  //
  //   document.getElementById("bookDes").textContent = "μ±… μ†κ°";
  //
  //   /* ===== λ„μ„ λ‚΄μ© ===== */
  //   document.getElementById('bookSummary').innerHTML = summary;
  //
  //   /* ===== μΈλ„¤μΌ ===== */
  //   const img = document.getElementById('bookBg');
  //   img.src = thumbnail;
  //
  //   /* ===== λ¨λ‹¬ ν‘μ‹ ===== */
  //   document.getElementById('bookDetailModal').classList.add('active');
  //
  //   /* ===== κ²€μƒ‰ λ²„νΌ ===== */
  //   const searchBtn = document.getElementById('modalSearchBtn');
  //
  //   // μ±… κµ¬λ§¤ λ²„νΌ
  //   searchBtn.textContent = 'μ±… κµ¬λ§¤ν•λ¬ κ°€κΈ° β' ;
  //
  //   // ν™μ„±ν™” + ν΄λ¦­ μ΄λ²¤νΈ
  //   searchBtn.disabled = false;
  //   searchBtn.onclick = () => {
  //     const query = encodeURIComponent(title);
  //     window.open(`https://www.yes24.com/product/search?domain=ALL&query=${query}`, '_blank');
  //   };
  // }
  //
  // /* μν™” λ¨λ‹¬ λ‹«κΈ° */
  // function closeMovieModal() {
  //   document.querySelector('.detailMovieModal').classList.remove('active');
  //   const searchBtn = document.getElementById('movieDetailModal');
  //   searchBtn.disabled = true;
  //   searchBtn.onclick = null; // μ΄λ²¤νΈ λ¦¬μ…‹
  // }
  //
  // /* μμ•… λ¨λ‹¬ λ‹«κΈ° */
  // function closeMusicModal() {
  //   document.querySelector('.detailMusicModal').classList.remove('active');
  //   const searchBtn = document.getElementById('musicDetailModal');
  //   searchBtn.disabled = true;
  //   searchBtn.onclick = null; // μ΄λ²¤νΈ λ¦¬μ…‹
  // }
  //
  // /* λ„μ„ λ¨λ‹¬ λ‹«κΈ° */
  // function closeBookModal() {
  //   document.querySelector('.detailBookModal').classList.remove('active');
  //   const searchBtn = document.getElementById('bookDetailModal');
  //   searchBtn.disabled = true;
  //   searchBtn.onclick = null; // μ΄λ²¤νΈ λ¦¬μ…‹
  // }
  //
  // function showMovieTrailer(title) {
  //   // μν™” μκ³ νΈ
  //   fetch(`/api/trailer/movie?title=${encodeURIComponent(title)}`)
  //   .then(res => res.json())
  //   .then(data => {
  //     if (data.movieVideoId) {
  //       const iframe = document.getElementById('trailerMovieIframe');
  //       iframe.src = `https://www.youtube.com/embed/${data.movieVideoId}?autoplay=1`;
  //       document.getElementById('trailerMovieModal').style.display = 'flex';
  //     } else {
  //       alert('μκ³ νΈμ„ μ°Ύμ„ μ μ—†μµλ‹λ‹¤.');
  //     }
  //   })
  //   .catch(() => alert('μν™”λ¥Ό λ¶λ¬μ¤λ” μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.'));
  //
  // }
  //
  // function showMusicTrailer(title) {
  //   // μμ•… μ νλΈ μ‹¤ν–‰
  //   fetch(`/api/trailer/music?title=${encodeURIComponent(title)}`)
  //   .then(res => res.json())
  //   .then(data => {
  //     if (data.musicVideoId) {
  //       const iframe = document.getElementById('trailerMusicIframe');
  //       iframe.src = `https://www.youtube.com/embed/${data.musicVideoId}?autoplay=1`;
  //       document.getElementById('trailerMusicModal').style.display = 'flex';
  //     } else {
  //       alert('μμ•…μ„ μ°Ύμ„ μ μ—†μµλ‹λ‹¤.');
  //     }
  //   })
  //   .catch(() => alert('μμ•…μ„ λ¶λ¬μ¤λ” μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.'));
  //
  // }
  //
  // function closeTrailerModal(modalId, iframeId) {
  //   const modal = document.getElementById(modalId);
  //   const iframe = document.getElementById(iframeId);
  //
  //   if (modal && iframe) {
  //     iframe.src = '';
  //     modal.style.display = 'none';
  //   }
  // }
  //
  // function handleModalBackgroundClick(event) {
  //   if (event.target.id === 'trailerModal') {
  //     closeTrailerModal();
  //   }
  // }

</script>
<script type="module" src="/js/modal.js"></script>