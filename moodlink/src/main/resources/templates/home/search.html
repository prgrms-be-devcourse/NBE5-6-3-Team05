<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
  <meta charset="UTF-8">
  <title>ê²€ìƒ‰ ê²°ê³¼</title>
  <style>
    .header- {
      position: static !important;
    }
    html, body {
      height: 100%;
      /*overflow: hidden; !* ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¡¤ ë§‰ê¸° *!*/
      margin: 0;
      padding: 0;
    }

    .container{
      display: flex;
      flex-direction: column;
      width: 100%;
      /*overflow-y: auto;*/
      margin-top: 60px;
      /*height: 100vh;*/
    }
    .container::-webkit-scrollbar {
      display: none;
    }
    .search-result-container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 2rem;
      text-align: center;
      font-family: 'Noto Sans KR', sans-serif;
    }


    .main-content {
      margin: 70px auto 0;
      justify-items: center;
    }

    .search-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 35px;
    }

    .category {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 30px;
      margin-top: 30px;
      flex-wrap: wrap;
    }

    .menu {
      display: flex;
      flex-direction: row;
      justify-content: center
    }
  </style>
</head>
<body>

<main layout:fragment="content" class="search-result-container">

    <div class="main-content container">

      <div class="search-container">
        <form id="searchAllForm" th:action="@{/search/all}" method="get">
          <input type="text" id="search-input" name="contentName" placeholder="ì›í•˜ëŠ” ìŒì•…,ì˜í™”,ë„ì„œë¥¼ ì°¾ì•„ë³´ì„¸ìš”!">
          <button type="submit">ê²€ìƒ‰</button>
        </form>
      </div>

      <br>

      <!-- ì¹´í…Œê³ ë¦¬ ë©”ë‰´ -->
      <div class="menu">
        <form id="searchMovieForm" th:action="@{/search/movie}" method="get">
          <input type="hidden" id="search-movie" name="contentName" >
        <button onclick="showCategory('movie')">ğŸ¬ ì˜í™”</button>
        </form>
        <form id="searchMusicForm" th:action="@{/search/music}" method="get">
          <input type="hidden" id="search-music" name="contentName" >
        <button onclick="showCategory('music')">ğŸ§ ìŒì•…</button>
        </form>
        <form id="searchBookForm" th:action="@{/search/book}" method="get">
          <input type="hidden" id="search-book" name="contentName" >
        <button onclick="showCategory('book')">ğŸ“š ë„ì„œ</button>
        </form>
      </div>

  <!-- contentName ì´ ìˆì„ ë•Œ -->
  <h4 th:unless="${#strings.isEmpty(contentName)}">
    "<span th:text="${contentName}"></span>" ì— ëŒ€í•œ ê²€ìƒ‰ê²°ê³¼ì…ë‹ˆë‹¤.
  </h4>


      <!--  ëª¨ë‹¬ì°½html-->
      <div id="modals-container"></div>

  <!-- ì˜í™” -->
        <div class="category" id="movie">
          <div th:if="${#strings.isEmpty(contentName)}">
          <form  id="searchMovieWithGenreForm" th:action="@{/search/genre/movie}" method="get">
            <input type="hidden" id="selectedMovieCategory" th:value="${selectedMovieCategory}" />
            <input type="hidden" name="genreName" id="movieGenreNameInput"/>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ëª¨í—˜')">ëª¨í—˜</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('íŒíƒ€ì§€')">íŒíƒ€ì§€</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ì• ë‹ˆë©”ì´ì…˜')">ì• ë‹ˆë©”ì´ì…˜</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ë“œë¼ë§ˆ')">ë“œë¼ë§ˆ</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ê³µí¬')">ê³µí¬</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ì•¡ì…˜')">ì•¡ì…˜</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ì½”ë¯¸ë””')">ì½”ë¯¸ë””</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ì—­ì‚¬')">ì—­ì‚¬</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ìŠ¤ë¦´ëŸ¬')">ìŠ¤ë¦´ëŸ¬</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ë²”ì£„')">ë²”ì£„</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ë‹¤íë©˜í„°ë¦¬')">ë‹¤íë©˜í„°ë¦¬</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('SF')">SF</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ë¯¸ìŠ¤í„°ë¦¬')">ë¯¸ìŠ¤í„°ë¦¬</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ë¡œë§¨ìŠ¤')">ë¡œë§¨ìŠ¤</button>
            <button type="button" class = "genre-btn" onclick="submitMovieGenre('ì „ìŸ')">ì „ìŸ</button>
          </form>
        </div>

          <div class="genre-title">
            <h4 th:if= "${movieContentWithGenre != null }" th:text="${genre}"></h4>
          </div>


          <div th:if="${movie != null and movie.size() > 0}" class="card-container">


    </div>
<!--    <h3><span class="highlight">ì˜í™”</span> ê²€ìƒ‰ ê²°ê³¼</h3>  -->
    <div th:if="${movie.size() > 0}" class="card-container">
      <div th:each="m : ${movie}" class="card-movie">
        <button type="button"
                class="details-btn"
                data-type="movies"
                th:attr="data-id=${m.id}">
          <img th:src="${m.thumbnail}" alt="ì˜í™” ì¸ë„¤ì¼" class="card-thumbnail"/>
        </button>
      </div>
    </div><br><br><br><br>
    <div th:if="${movie.size() == 0}"><h4>ê²€ìƒ‰ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</h4></div>
  </div>

<!-- 
          <div th:if="${movieContentWithGenre != null and movieContentWithGenre.size() > 0 }" class="card-container">
            <div th:each="mg : ${movieContentWithGenre}" class="card-movie"
                 th:attr="onclick='showDetailModalMovie(' +
                 '\'' + ${#strings.escapeJavaScript(mg.title)} + '\',' +
                 '\'' + ${#strings.escapeJavaScript(mg.releaseDate)} + '\',' +
                 '\'' + ${#strings.escapeJavaScript(mg.summary)} + '\',' +
                 '\'' + ${#strings.escapeJavaScript(mg.thumbnail)} + '\'' +
                 ')'"
            > -->

      <!--ìŒì•… -->
        <div class="category" id="music">
          <div th:if="${#strings.isEmpty(contentName)}">
            <form  id="searchMusicWithGenreForm" th:action="@{/search/genre/music}" method="get">
            <input type="hidden" id="selectedMusicCategory" th:value="${selectedMusicCategory}" />
            <input type="hidden" name="genreName" id="musicGenreNameInput"/>
            <button type="button" class = "genre-btn" onclick="submitMusicGenre('ë°œë¼ë“œ')">ë°œë¼ë“œ</button>
            <button type="button" class = "genre-btn" onclick="submitMusicGenre('ëŒ„ìŠ¤')">ëŒ„ìŠ¤</button>
            <button type="button" class = "genre-btn" onclick="submitMusicGenre('í™í•©')">í™í•©</button>
            <button type="button" class = "genre-btn" onclick="submitMusicGenre('R&B')">R&B</button>
            <button type="button" class = "genre-btn" onclick="submitMusicGenre('ì¸ë””ìŒì•…')">ì¸ë””ìŒì•…</button>
            <button type="button" class = "genre-btn" onclick="submitMusicGenre('ë¡/ë©”íƒˆ')">ë¡/ë©”íƒˆ</button>
            <button type="button" class = "genre-btn" onclick="submitMusicGenre('íŠ¸ë¡œíŠ¸')">íŠ¸ë¡œíŠ¸</button>
            <button type="button" class = "genre-btn" onclick="submitMusicGenre('í¬í¬/ë¸”ë£¨ìŠ¤')">í¬í¬/ë¸”ë£¨ìŠ¤</button>
          </form>
          </div>

          <div class="genre-title">
            <h4 th:if= "${musicContentWithGenre != null }" th:text="${genre}"></h4>
          </div>


    <!--    <h3><span class="highlight">ìŒì•…</span> ê²€ìƒ‰ ê²°ê³¼</h3>-->

    <div th:if="${music.size() > 0}" class="card-container">
      <div th:each="m : ${music}" class="card-music">
        <button type="button"
                class="details-btn"
                data-type="musics"
                th:attr="data-id=${m.id}">
          <img th:src="${m.thumbnail}" alt="ìŒì•… ì¸ë„¤ì¼" class="card-thumbnail"/>
        </button>
      </div>
    </div><br><br><br><br>
    <div th:if="${music.size() == 0}"><h4>ê²€ìƒ‰ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</h4></div>
  </div>



    <div th:if="${book.size() > 0}" class="card-container">
      <div th:each="b : ${book}" class="card-book">
        <button type="button"
                class="details-btn"
                data-type="books"
                th:attr="data-id=${b.isbn}">
          <img th:src="${b.image}" alt="ë„ì„œ ì¸ë„¤ì¼" class="card-thumbnail modal-bg.book"/>
        </button>
      </div>
    </div><br><br><br><br>
    <div th:if="${book.size() == 0}"><h4>ê²€ìƒ‰ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</h4></div>
  </div>


  <!-- ë„ì„œ -->
        <div class="category" id="book">
          <div th:if="${#strings.isEmpty(contentName)}">
          <form  id="searchBookWithGenreForm" th:action="@{/search/genre/book}" method="get">
            <input type="hidden" id ="selectedBookCategory" th:value="${selectedBookCategory}" />
            <input type="hidden" name="genreName" id="bookGenreNameInput"/>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ë™í™”')">ë™í™”</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ë¼ì´íŠ¸ë…¸ë²¨')">ë¼ì´íŠ¸ë…¸ë²¨</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ë¬´í˜‘ì†Œì„¤')">ë¬´í˜‘ì†Œì„¤</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ìˆ˜í•„')">ìˆ˜í•„</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ì‹œì§‘')">ì‹œì§‘</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ì¶”ë¦¬ì†Œì„¤')">ì¶”ë¦¬ì†Œì„¤</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('íŒíƒ€ì§€ì†Œì„¤')">íŒíƒ€ì§€ì†Œì„¤</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('í”„ë¡œê·¸ë˜ë°')">í”„ë¡œê·¸ë˜ë°</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ì¸ë¬¸í•™')">ì¸ë¬¸í•™</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ì‹¬ë¦¬í•™')">ì‹¬ë¦¬í•™</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ì² í•™')">ì² í•™</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ë¬¸í™”ì¸ë¥˜í•™')">ë¬¸í™”ì¸ë¥˜í•™</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ì¢…êµí•™')">ì¢…êµí•™</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('í•œêµ­ì†Œì„¤')">í•œêµ­ì†Œì„¤</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ì™¸êµ­ì†Œì„¤')">ì™¸êµ­ì†Œì„¤</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ê³ ì „ë¬¸í•™')">ê³ ì „ë¬¸í•™</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('í˜„ëŒ€ë¬¸í•™')">í˜„ëŒ€ë¬¸í•™</button>
            <button type="button" class = "genre-btn" onclick="submitBookGenre('ì‚¬íšŒí•™')">ì‚¬íšŒí•™</button>
          </form>
          </div>


<!--           <div th:if="${bookContentWithGenre != null and bookContentWithGenre.size() > 0}" class="card-container">
            <div th:each="bg : ${bookContentWithGenre}" class="card-book"
                 th:attr = "onclick=
             'showDetailModalBook(' +
               '\'' + ${#strings.escapeJavaScript(bg.title)} + '\',' +
               '\'' + ${#strings.escapeJavaScript(bg.publishedDate)} + '\',' +
               '\'' + ${#strings.escapeJavaScript(bg.description)} + '\',' +
               '\'' + ${#strings.escapeJavaScript(bg.image)} + '\',' +
             ')'">
              <img th:src="${bg.image}" alt="ë„ì„œ ì¸ë„¤ì¼" class="card-thumbnail modal-bg.book"/>
            </div>
          </div><br><br><br><br>
          <div th:if="${bookContentWithGenre == null and book == null}"><h4>ë„ì„œ ê²€ìƒ‰ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</h4></div>
        </div> -->


</main>
</body>
</html>

<script>


  // ëª¨ë‹¬ì°½ html ë¶ˆëŸ¬ì˜¤ê¸°
  fetch('/html/modals.html')
  .then(response => response.text())
  .then(data => {
    document.getElementById('modals-container').innerHTML = data;
  });

  /* ì¹´í…Œê³ ë¦¬ í† ê¸€ */
  function showCategory(id) {
    document.querySelectorAll('.category').forEach(c => c.style.display = 'none');
    document.getElementById(id).style.display = 'block';
  }

  document.addEventListener('DOMContentLoaded', () => {
    const musicCategory = document.getElementById('selectedMusicCategory')?.value;
    const bookCategory = document.getElementById('selectedBookCategory')?.value;
    const movieCategory = document.getElementById('selectedMovieCategory')?.value;

    // ê° ì¹´í…Œê³ ë¦¬ ê°’ì´ ì¡´ì¬í•˜ë©´ showCategory ì‹¤í–‰
    if (musicCategory) showCategory(musicCategory);
    if (bookCategory) showCategory(bookCategory);
    if (movieCategory) showCategory(movieCategory);
  });


  function searchByGenre(genre) {
    window.location.href = '/search/genre?genreName=' + encodeURIComponent(genre);

  }

</script>
<script type="module" src="/js/modal.js"></script>