<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <th:block th:fragment="frg_static">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
      body {
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        margin: 0;
        font-family: 'Segoe UI', sans-serif;
        background: linear-gradient(#000000, #683997);
        color: white;
        background-attachment: fixed;
        background-position: center;
        overscroll-behavior: none;
      }

      header {
        display: flex;
        justify-content: space-between;
        padding-top: 30px;
        padding-left: 30px;
        width: 100%;
        position: fixed;
        margin-top: -16px;
        z-index: 9999;
      }

      .logo {
        font-size: 48px;
        font-weight: bold;
        margin-right: 20px;
      }

      .logo span {
        background: linear-gradient(to bottom, #A64DFF, #6A00FF);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .header-right {
        display: flex;
        margin-right: 10px;
        align-items: center;
        gap: 16px;
      }

      .welcome-text {
        font-size: 20px;
        margin-right: 10px;
      }

      .header-buttons {
        display: flex;
        font-size: 20px;
      }

      .header-buttons button {
        padding: 8px 16px;
        margin-right: 10px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-weight: bold;
      }

      .mypage-btn {
        background: linear-gradient(to right, #A64DFF, #6A00FF);
        color: white;
      }

      .logout-btn {
        background: linear-gradient(to right, #A64DFF, #6A00FF);
        color: white;
      }

      .login-btn {
        background: linear-gradient(to right, #A64DFF, #6A00FF);
        color: white;
      }

      .main-content {
        max-width: 100vw;
        margin: 0 auto;
        text-align: center;
      }

      .category {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        gap: 30px;
        margin-top: 30px;
        flex-wrap: wrap;
      }

      .category-card {
        backdrop-filter: blur(10px);
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        border: 1px solid rgba(255, 255, 255, 0.15);
        box-shadow:
            0 0 15px rgba(186, 85, 211, 0.6),
            0 0 30px rgba(186, 85, 211, 0.4),
            0 0 45px rgba(186, 85, 211, 0.3),
            0 0 60px rgba(186, 85, 211, 0.2),
            0 8px 24px rgba(0, 0, 0, 0.3);
        padding: 20px;
        width: 260px;
        text-align: center;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
      }

      .category-card:hover {
        transform: translateY(-12px) scale(1.08);
        box-shadow:
            0 0 20px rgba(186, 85, 211, 0.8),
            0 0 40px rgba(186, 85, 211, 0.6),
            0 0 60px rgba(186, 85, 211, 0.5),
            0 0 80px rgba(186, 85, 211, 0.4),
            0 0 100px rgba(186, 85, 211, 0.3),
            0 20px 60px rgba(0, 0, 0, 0.5);
      }

      .category-card::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(255, 99, 71, 0.3) 0%, transparent 70%);
        transform: rotate(45deg);
        opacity: 0;
        transition: opacity 0.4s ease;
        z-index: 0;
      }

      .category-card:hover::before {
        opacity: 1;
      }

      .category-card img {
        width: 220px;
        height: 280px;
        object-fit: cover;
        border-radius: 15px;
        border: 2px solid #ff6347;
        box-shadow: 0 5px 15px rgba(255, 99, 71, 0.2);
        z-index: 1;
        position: relative;
      }

      .category-card p {
        margin-top: 15px;
        font-size: 18px;
        font-weight: 600;
        color: #fff;
        letter-spacing: 1px;
        text-transform: uppercase;
        z-index: 1;
        position: relative;
      }

      .header-menu{
        display: flex;
        justify-content: flex-start;
      }

      .fancy-button {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 10px 10px;
        font-size: 18px;
        font-weight: 600;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        color: white;
        transition: all 0.3s ease-in-out;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        background: rgb(0, 0, 0, 0.1);
        background-size: 100% auto;
        text-transform: uppercase;
        position: relative;
        overflow: hidden;
      }

      .fancy-button i {
        font-size: 20px;
        transition: transform 0.3s ease;
      }

      .fancy-button:hover i {
        transform: rotate(15deg) scale(1.2);
      }

      .fancy-button:hover {
        background-position: right center;
        transform: translateY(-2px);
        box-shadow: 0 6px 24px rgba(0, 0, 0, 0.4);
      }

      .red-button {
        background-image: linear-gradient(to right, #f12711, #f5af19);
      }

      .purple-button {
        background-image: linear-gradient(to right, #7F00FF, #E100FF);
      }

      .buttons {
        margin: 12px;
      }

      .content-info {
        display: none;
        background-color: rgba(255, 255, 255, 0.05);
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        margin-top: 10px;
        padding-top: 10px;
        font-size: 14px;
        color: #fff;
      }

      .content-title {
        color: #d4ff47;
        font-weight: bold;
      }

      /*운세 모달*/

      /* ───── 모달 배경 그대로 ───── */
      .fortune-modal {
        display: none;
        position: fixed;
        inset: 0;
        z-index: 9999;
        background: rgba(0, 0, 0, .45);
        overflow: hidden;
      }

      .fortune-modal.active {
        display: flex;
        justify-content: center;
        align-items: center
      }

      /* ───── 파티클(별빛) ───── */
      .fortune-modal::before {
        content: '';
        position: absolute;
        inset: -50%;
        background: radial-gradient(white 1px, transparent 1px);
        background-size: 20px 20px;
        opacity: .07;
        animation: twinkle 8s linear infinite;
      }

      @keyframes twinkle {
        from {
          transform: translate3d(0, 0, 0)
        }
        to {
          transform: translate3d(50px, 50px, 0)
        }
      }

      /* ───── 모달 박스 ───── */
      .fortune-modal-content {
        overflow: hidden; /* 모달 밖으로 넘치는 글씨 숨기기 */
        position: relative;
        /* 기존 스타일 유지 */
        width: min(600px, 90%);
        padding: 50px 40px;
        background: linear-gradient(145deg, #222 30%, #2d0054 130%);
        border-radius: 16px;
        box-shadow: 0 0 25px rgba(255, 204, 102, .45),
        0 0 60px rgba(102, 153, 255, .25);
        color: #fff;
        animation: dropIn .7s cubic-bezier(.25, .85, .4, 1.1) forwards;
      }

      .scrolling-wrapper {
        overflow: hidden; /* 글씨가 넘치면 숨김 */
        width: 100%; /* 모달 너비에 맞춤 */
        box-sizing: border-box;
      }

      /* 빛나는 오라 */
      .fortune-modal-content::after {
        content: '';
        position: absolute;
        inset: -40%;
        background: conic-gradient(from 0deg, #ffcc66 0 10%, transparent 40% 60%, #6699ff 85% 100%);
        filter: blur(45px);
        opacity: .18;
        animation: rotate 6s linear infinite;
        pointer-events: none;
      }

      @keyframes dropIn {
        0% {
          transform: translateY(-120px) scale(.8);
          opacity: 0
        }
        80% {
          transform: translateY(10px) scale(1);
          opacity: 1
        }
        100% {
          transform: translateY(0) scale(1)
        }
      }

      @keyframes rotate {
        to {
          transform: rotate(360deg)
        }
      }

      .fortune-result {
        white-space: nowrap;
        width: max-content; /* 텍스트 길이에 맞게 넓이 조절 */
        position: relative;
      }

      .scrolling-text {
        animation-name: scroll-left;
        animation-timing-function: linear;
        animation-iteration-count: infinite;
        animation-duration: 15s; /* 필요에 따라 속도 조절 */
      }

      @keyframes scroll-left {
        0% {
          transform: translateX(100%);
        }
        100% {
          transform: translateX(-100%);
        }
      }


      .close-btn {
        position: absolute;
        top: 15px;
        right: 20px;
        font-size: 28px;
        font-weight: bold;
        color: #fff;
        cursor: pointer;
      }

      .close-btn:hover {
        color: #000;
      }

      .fancy-button.blue-button {
        background-color: #3f51b5;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 12px;
        font-size: 16px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .fancy-button.blue-button:hover {
        background-color: #303f9f;
      }

      .search-container {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 35px;
      }

      h3 {
        margin-top: 16px;
        margin-bottom: 16px;
      }

      .search-container input,
      .search-container button {
        color: white;
      }

      .search-container input {
        background-color: #794caf;
        border: 1px solid #794caf;
        padding: 8px;
        border-radius: 4px;
      }

      .search-container button {
        background-color: #794caf;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        margin-left: 20px;
      }

      #search-input {
        padding-left: 10px;
        width: 300px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 6px;
      }

      #search-input:focus {
        border-color: #794caf;
        outline: none;
        box-shadow: 0 0 8px rgba(76, 175, 80, 0.4);
      }

      button {
        padding: 10px 20px;
        font-size: 16px;
        background-color: #794caf;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
      }

      .search-container button:hover {
        background-color: #794caf;

        button:hover {
          background-color: #794caf;
        }

        button:active {
          background-color: #794caf;
        }
      }

      .image {
        width: 300px;
        height: auto;
      }

      .fortune-message {
        display: none;
        font-size: 1.2rem;
        color: #f0f0f0;
        text-align: center;
        font-style: italic;
        animation: fadeIn 1.2s ease-in-out;
        margin-bottom: 10px;
      }

      @keyframes fadeIn {
        0% {
          opacity: 0;
          transform: translateY(10px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes typewriter {
        0% {
          width: 0;
        }
        100% {
          width: 100%;
        }
      }

      .fortune-result {
        display: none;
        font-size: 1.8rem;
        font-weight: bold;
        color: #ff8c00;
        text-align: center;
        font-family: 'Arial', sans-serif;
        white-space: nowrap;
        overflow: hidden;
        border-right: .15em solid #ff8c00;
        animation: typewriter 3s steps(30) 1s 1 normal both, blink-caret 0.75s step-end infinite; /* 타자기 효과 애니메이션 */
        letter-spacing: 0.1em;
        text-shadow: 0 0 15px rgba(255, 140, 0, 0.7);
      }

      @keyframes blink-caret {
        0%, 100% {
          border-right-color: transparent;
        }
        50% {
          border-right-color: #ff8c00;
        }
      }

      .fortune-result.done {
        border-right: none;
      }



      .content-grid {
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }

      .content-item {
        display: flex;
        gap: 1.5rem;
        border-bottom: 1px solid #e0e0e0;
        padding-bottom: 1.5rem;
      }

      .content-thumbnail {
        width: 120px;
        height: 120px;
        object-fit: cover;
        border-radius: 8px;
      }

      .content-info {
        flex: 1;
      }

      .content-title {
        font-size: 1.2rem;
        font-weight: bold;
        margin: 0 0 0.3rem;
      }

      .content-description {
        /*font-size: 1.25rem;*/
        font-size: 1.5rem;
        margin: 1.0rem 0;
        color: #ffffff;
        line-height: 1.4;

      }

      .content-subtext {
        font-size: 0.85rem;
        color: #ffffff;
      }

      .genre-list {
        list-style: none;
        padding: 0;
        margin: 0.5rem 0 0;
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .genre-tag {
        background-color: #f0f0f0;
        padding: 0.3rem 0.6rem;
        border-radius: 6px;
        font-size: 0.8rem;
      }

      .no-result {
        text-align: center;
        color: #ffffff;
        font-size: 1rem;
      }

      /*검색결과 디자인*/
      /* 카드 공통 */
      .card-container {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 16px
      }

      /* 공통 호버 효과 */
      .card-container > div:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 16px rgba(0, 0, 0, .4);
      }

      /* 부드러운 애니메이션 */
      .card-container > div {
        transition: transform .25s ease, box-shadow .25s ease;
      }

      /* 영화 */
      .card-movie {
        width: 300px;
        border: 4px solid;
        border-image: linear-gradient(to right, #FF512F, #DD2476) 1;
        border-radius: 6px;
        cursor: pointer;
        box-sizing: border-box;
        background: #000;
      }

      .card-movie .card-thumbnail {
        width: 100%;
        border-radius: 4px;
        display: block
      }

      /* 음악 */
      .card-music {
        width: 210px;
        border: 4px solid;
        border-image: linear-gradient(to right, #1FA2FF, #12D8FA, #A6FFCB) 1;
        border-radius: 6px;
        cursor: pointer;
        box-sizing: border-box;
        background: #000;
      }

      .card-music .card-thumbnail {
        width: 100%;
        border-radius: 4px;
        display: block
      }


      /* 도서 */
      .card-book {
        flex: 1 1 calc(28% - 16px);
        max-width: 250px;

        border: 4px solid;
        border-image: linear-gradient(to right, #a34dff, #2ebf91) 1;
        border-radius: 6px;
        cursor: pointer;
        box-sizing: border-box;
        background: #000;
      }

      .card-book .card-thumbnail {
        width: 100%;
        border-radius: 4px;
        display: block;
      }

      /*검색 모달*/

      .detailMovieModal {
        display: none;
      }

      /* 영화 모달 배경 */
      .detailMovieModal.active {
        /*display: flex*/
        display: block;
      }

      .detailMusicModal {
        display: none;
        position: fixed;
        inset: 0;
        z-index: 1000;
        background: rgba(0, 0, 0, .75);
        justify-content: center;
        align-items: center
      }

      .detailMusicModal.active {
        display: flex
      }

      .detailBookModal {
        display: none;
        position: fixed;
        inset: 0;
        z-index: 1000;
        background: rgba(0, 0, 0, .75);
        justify-content: center;
        align-items: center
      }

      .detailBookModal.active {
        display: flex
      }

      /* 모달 내용 */
      .search-modal-content {
        display: flex;
        max-width: 900px;
        width: 90%;
        height: 70vh;
        overflow: hidden;
        border-radius: 8px
      }

      .modal-bg {
        flex: 1 1 55%;
        object-fit: cover
      }

      .modal-info {
        flex: 1 1 45%;
        background: #000;
        color: #fff;
        padding: 40px 50px;
        position: relative;
        display: flex;
        flex-direction: column;
        gap: 20px;
        overflow-y: auto
      }

      .modal-close {
        position: absolute;
        top: 20px;
        right: 25px;
        font-size: 28px;
        cursor: pointer
      }

      .modal-title {
        font-size: 40px;
        font-weight: 700;
        margin: 0
      }

      .modal-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin: 0;
        padding: 0;
        justify-content: center;
      }

      .modal-badges li {
        list-style: none;
        font-size: 14px;
        font-weight: 600;
        background: #444;
        padding: 4px 10px;
        border-radius: 4px
      }

      .modal-summary {
        line-height: 1.5;
        font-size: 16px
      }

      .modal-play {
        align-self: center;
        padding: 12px 28px;
        font-size: 18px;
        font-weight: 600;
        border: none;
        border-radius: 4px;
        background: #632e9c;
        color: #fff;
        cursor: pointer
      }

      .modal-bg.music {
        flex: 1 1 55%; /* 필요하면 50% 이하로 */
        max-height: 60vh;
        max-width: 20vw; /* 가로폭 ↓ */
      }

      .modal-bg.book {
        flex: 1 1 70%; /* 가로폭 축소 – 숫자는 취향껏 조정 */
        max-height: 60vh; /* 가로·세로 비율 그대로 축소 */
      }

      /*.card-book.search-result {*/
      /*  flex: 1 1 100%;*/
      /*  max-width: none;*/
      /*}*/


      .highlight {
        color: #a3cf22; /* 포인트 색상 */
        font-weight: 700; /* 굵게(선택) */
      }

      .trailer-modal {
        position: fixed;
        top: 30px; left: 0;
        width: 100vw; height: 100vh;
        background: rgba(0,0,0,0.7);
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1200;
      }

      .trailer-modal-content {
        position: relative;
        background: #000;
        padding: 1rem;
        border-radius: 10px;
      }

      .trailer-modal-close {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 1.5rem;
        color: #fff;
        cursor: pointer;
      }

      /* 모달 본문 레이아웃 */
      .custom-modal-body-layout {
        display: flex;
        gap: 2rem;
        align-items: flex-start;
        margin-top: 1rem;
      }

      #modal-search-link:hover {
        background-color: #a855f7;
      }

      /*모달 창 내 텍스트 전체보기/간략히 보기*/
      .text-button {
        background: none;
        border: none;
        color: #aaa;
        font-size: 0.8rem;
        cursor: pointer;
        padding: 0;
        text-decoration: underline;
        opacity: 0.7;
        transform: scale(0.9);
      }

      .text-button:hover {
        color: #ccc;
        opacity: 1;
      }

      /* 모달 스타일 */

      detailModalResult {
        display: none;
        position: fixed;
        inset: 0;
        z-index: 1000;
        background: rgba(0, 0, 0, .75);
        justify-content: center;
        align-items: center
      }

      detailModalResult.active {
        display: flex
      }

      /* 전체 모달 배경 (검은 반투명 배경) */
      .custom-modal {
        display: flex; /* 기본 display는 JS에서 hidden 클래스로 토글 관리 */
        justify-content: center;
        align-items: center;
        position: fixed;
        inset: 0;
        z-index: 9999;
        background-color: rgba(0, 0, 0, 0.8);
      }

      /* JS에서 모달을 숨길 때 사용할 클래스 */
      .custom-modal.hidden {
        display: none;
      }

      /* 모달 내부 콘텐츠 영역 */
      .custom-modal-content {
        background-color: #1a1a1a;
        padding: 2rem;
        border-radius: 10px;
        max-width: 800px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        position: relative;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        color: white;
      }

      /* 닫기 버튼 (오른쪽 위 X 버튼) */
      .custom-close-btn {
        position: absolute;
        top: 16px;
        right: 20px;
        font-size: 24px;
        font-weight: bold;
        color: #fff;
        cursor: pointer;
        background: none;
        border: none;
      }

      .custom-close-btn:hover {
        color: #aaa;
      }

      /* 이미지 영역 */
      .custom-modal-body-main img,
      .custom-modal-img {
        width: 200px;
        max-height: 250px;
        object-fit: contain;
        border-radius: 0;
      }

      /* 텍스트 정보 영역 */
      .custom-modal-info {
        flex: 1;
        overflow-wrap: break-word;
      }

      /* 설명문 내부 여백 */
      #custom-modal-meta p {
        margin: 0.5rem 0;
      }

      /* 아래쪽 버튼 영역 */
      #modal-like-wrapper {
        margin-top: 1.5rem;
        text-align: right;
      }


      /* PICK 강조 태그 */
      .pick-tag {
        display: inline-block;
        background-color: #a259ff;
        color: white;
        font-weight: bold;
        padding: 4px 8px;
        border-radius: 6px;
        margin-top: 10px;
      }



      /* 별 버튼은 hover 배경 없음 */
      .toggle-star-btn {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(15, 23, 42, 0.7);
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 1.5rem;
        color: #facc15;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(5px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        z-index: 2;
      }

      .toggle-star-btn:hover {
        transform: scale(1.2) rotate(10deg);
        color: #fef08a;
        background: rgba(15, 23, 42, 0.9);
        box-shadow: 0 4px 12px rgba(250, 204, 21, 0.5);
      }


      .genre-title {
        padding-bottom: 24px;
        text-align: center;
      }

      .genre-title h4 {
        font-size: 28px;
        font-weight: 700;
        color: #d1b3ff; /* 연보라 */
        font-family: 'Pretendard', 'Segoe UI', 'Apple SD Gothic Neo', sans-serif;
        letter-spacing: 0.8px;
        text-shadow:
            0 0 6px rgba(209, 179, 255, 0.6),
            0 0 12px rgba(209, 179, 255, 0.4),
            0 0 18px rgba(209, 179, 255, 0.2);
        margin-top: 30px;
        position: relative;
        display: inline-block;
      }


      .genre-button-container {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin: 25px 0;
        justify-content: center;
      }

      .genre-btn {
        padding: 10px 20px;
        border: none;
        border-radius: 30px;
        background-color: #f7f7f7;
        color: #222;
        font-family: 'Segoe UI', 'Pretendard', 'Apple SD Gothic Neo', sans-serif;
        font-weight: 500;
        font-size: 15.5px;
        letter-spacing: 0.5px;
        cursor: pointer;
        box-shadow: 2px 2px 8px rgba(0,0,0,0.08);
        transition: all 0.2s ease;
      }

      .genre-btn:hover {
        background-color: #0066ff;
        color: white;
        transform: translateY(-2px);
        box-shadow: 2px 4px 12px rgba(0,0,0,0.2);
      }

      .menu {
        display: flex;
        gap: 10px; /* 버튼 사이 여백 */
      }

      .menu form {
        margin: 0; /* 기본 여백 제거 */
      }

      .menu button {
        padding: 8px 16px;
        font-size: 16px;
        cursor: pointer;
      }

      #search-container {
        display: flex;
        justify-content: center;
        align-items: center;
        /*margin-top: 100px; !* 헤더 높이보다 큰 여백을 확보 *!*/
        z-index: 1;
        position: relative;
      }

      #searchAllButton button {
        background-color: #6C63FF;
        color: white;
        border: none;
        padding: 14px 28px;
        font-size: 16px;
        font-weight: 600;
        border-radius: 10px;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        transition: background-color 0.3s ease, transform 0.2s ease;
      }

      #searchAllButton button:hover {
        background-color: #5751d6;
        transform: translateY(-3px);
      }

      .empty-message-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 60vh;
        /* 배경색 제거 */
      }

      .empty-message-box {
        background-color: #fff6e8; /* 콘텐츠 박스만 배경 */
        border: 1px solid #f1c995;
        border-radius: 20px;
        padding: 40px 60px;
        text-align: center;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
        max-width: 600px;
        animation: fadeIn 0.8s ease-in-out;
      }

      .empty-message-box h2 {
        font-size: 1.8rem;
        color: #b36b00;
        margin-bottom: 12px;
      }

      .empty-message-box p {
        font-size: 1.1rem;
        color: #6b4c1e;
      }

      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }

      .recommendation-container .swiper-slide {
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border-radius: 10px;
      }

      .recommendation-container .swiper-slide:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 20px rgba(255, 255, 255, 0.2);
      }

      /* 영화 - 붉은 느낌 */
      .search-title.movie h4 {
        color: #ff6b6b; /* 밝은 빨강 */
        text-shadow:
            0 0 6px rgba(255, 107, 107, 0.6),
            0 0 12px rgba(255, 107, 107, 0.4),
            0 0 18px rgba(255, 107, 107, 0.2);
        display: block;       /* 블록 요소로 확실히 */
        width: 100%;          /* 가로 꽉 채우기 */
        margin-bottom: 16px;  /* 아래 여백 */
      }

      /* 음악 - 파란 느낌 */
      .search-title.music h4 {
        color: #4a90e2; /* 밝은 파랑 */
        text-shadow:
            0 0 6px rgba(74, 144, 226, 0.6),
            0 0 12px rgba(74, 144, 226, 0.4),
            0 0 18px rgba(74, 144, 226, 0.2);
        display: block;       /* 블록 요소로 확실히 */
        width: 100%;          /* 가로 꽉 채우기 */
        margin-bottom: 16px;  /* 아래 여백 */
      }

      /* 도서 - 초록 느낌 */
      .search-title.book h4 {
        color: #7ed56f; /* 연두 초록 */
        text-shadow:
            0 0 6px rgba(126, 213, 111, 0.6),
            0 0 12px rgba(126, 213, 111, 0.4),
            0 0 18px rgba(126, 213, 111, 0.2);
      }



    </style>

  </th:block>
</head>
<body>
<!--<div layout:fragment="content">-->
<th:block th:fragment="frg_header">
  <header class ="header-">
    <div class="header-menu">
      <a th:href="@{/}">
        <div class="logo"><span>Moodlink</span></div>
      </a>
      <form th:action="@{/search/all}" method="get"
      style="display: flex; flex-direction: row; align-items: center;">
        <input type="hidden" name="contentName" value="" />
        <button class="fancy-button" type="submit">
          컨텐츠 전체 보기
        </button>
      </form>
      <button class="fancy-button" th:onclick="|location.href='@{/recommend}'|">
        <i class="material-icons">stars</i>
        추천받기
      </button>
      <button class="fancy-button"
              th:onclick="|location.href='@{/worldcup}'|">
        <i class="material-icons">sports_esports</i>
        월드컵
      </button>

      <button class="fancy-button" onclick="openFortuneModal()">
        <i class="material-icons">auto_awesome</i>
        오늘의 운세
      </button>
    </div>
    <div id="fortuneModal" class="fortune-modal" onclick="closeModal(event)">
      <div class="fortune-modal-content" onclick="event.stopPropagation()">
        <div class="scrolling-wrapper">
          <span class="close-btn" onclick="closeModal()">&times;</span>
          <h4 style="color: #814700 ; margin-bottom: 20px; text-align: center;">오늘의 운세</h4>

          <div id="fortuneText">
            <p id="fortuneMsg1" class="fortune-message" style="display: none;">당신의 오늘을 위한 짧은
              안내서입니다.</p>
            <p id="fortuneMsg2" class="fortune-message" style="display: none;">이 운세가 당신의 하루에 작은
              방향이 되길 바랍니다.</p>
            <p id="fortuneResult" class="fortune-result  scrolling-text"
               style="display: none;"></p>

          </div>

          <div style="margin-top: 20px; text-align: center;">
            <button id="retryFortuneBtn" class="fancy-button blue-button"
                    onclick="retryFortune()">
              다시 추천받기
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="header-right">
      <span th:if="${isAuthenticated}" th:text="'안녕하세요, ' + ${username} + '님!'"></span>
      <div class="header-buttons">
        <button class="mypage-btn" sec:authorize="hasRole('USER')"
                th:onclick="|location.href='@{/users}'|">마이페이지
        </button>
        <button class="mypage-btn" sec:authorize="hasRole('ADMIN')"
                th:onclick="|location.href='@{/admin/movies}'|">관리자페이지
        </button>
        <button id = "logout" class="logout-btn" th:if="${isAuthenticated}">로그아웃</button>
        <form th:action="@{/signin}" method="get">
          <button class="login-btn" th:if="${!isAuthenticated}" th:href="@{/signin}">로그인</button>
        </form>
      </div>
    </div>
  </header>

  <script th:inline="javascript">
    function startScrollingAnimation() {
      const result = document.getElementById('fortuneResult');
      const container = result.parentElement;

      const containerWidth = container.offsetWidth;
      const textWidth = result.scrollWidth;

      result.style.animation = 'none';
      result.classList.remove('scrolling-text');

      if (textWidth > containerWidth) {
        // 애니메이션 적용
        const distance = textWidth + containerWidth;
        const speed = 100;
        const duration = distance / speed;

        result.style.animationName = 'scroll-left';
        result.style.animationDuration = duration + 's';
        result.style.animationTimingFunction = 'linear';
        result.style.animationIterationCount = 'infinite';

        result.classList.add('scrolling-text');
      }
    }

    function openFortuneModal() {
      const modal = document.getElementById("fortuneModal");
      modal.classList.add('active');

      const msg1 = document.getElementById("fortuneMsg1");
      const msg2 = document.getElementById("fortuneMsg2");
      const result = document.getElementById("fortuneResult");

      msg1.style.display = "none";
      msg2.style.display = "none";
      result.style.display = "none";
      result.textContent = "";

      msg1.style.display = "block";

      setTimeout(() => {
        msg1.style.display = "none";
        msg2.style.display = "block";

        setTimeout(() => {
          msg2.style.display = "none";

          fetch('/fortune')
            .then(response => response.text())
            .then(data => {
              const result = document.getElementById('fortuneResult');
              result.textContent = data;
              result.style.display = "block";

              startScrollingAnimation();
            })

            .catch(() => {
              result.textContent = "운세를 불러오지 못했습니다.";
              result.style.display = "block";
            });

        }, 2000);

      }, 2000);
    }

    function closeModal(event) {
      if (event) {
        event.stopPropagation();
      }
      const modal = document.getElementById("fortuneModal");
      modal.classList.remove('active');   // display:none 대신 active 클래스 제거
    }

    function retryFortune() {
      const result = document.getElementById("fortuneResult");

      fetch('/fortune/ai', {
        method: 'POST'
      })
        .then(res => res.text())
        .then(data => {
          result.textContent = data;
          // 애니메이션 재시작을 위해 클래스 제거 후 다시 추가
          result.classList.remove("scrolling-text");
          void result.offsetWidth; // 리플로우 강제 발생
          result.classList.add("scrolling-text");
        })
        .catch(() => {
          result.textContent = "운세를 불러올 수 없습니다.";
          result.classList.remove("scrolling-text");
        });
    }

    document.addEventListener("DOMContentLoaded", function () {
      const result = document.querySelector('.fortune-result');
      if (result) {
        result.style.display = 'block';

        setTimeout(() => {
          result.classList.add('done');
        }, 15000);
      }
    });
    document.querySelector("#logout").addEventListener('click', async () => {
      console.log("로그아웃 버튼 누름 확인");

      await fetch('/auth/logout', {
        method: 'POST',
        credentials: 'include',
        headers: {
          'Content-Type': 'application/json'
        }
      })
        .then(res => {
          if (res.ok) {
            window.location.href = '/';
          }
        })
    });
  </script>

</th:block>
<!-- pagination -->
<ul class="pagination" th:fragment="frg_pagination">
  <li class="waves-effect">
    <a th:href="@{${page.url()}(page=${page.prevPage()})}"><i
        class="material-icons">chevron_left</i></a></li>
  <li th:each="num : ${#numbers.sequence(page.startNumber(), page.endNumber())}"
      th:classappend="${num == page.currentNumber()} ? 'active white-text' : 'waves-effect'">
    <a th:href="@{${page.url()}(page=${num})}" th:text="${num}">1</a>
  </li>
  <li class="waves-effect">
    <a th:href="@{${page.url()}(page=${page.nextPage()})}"><i
        class="material-icons">chevron_right</i></a></li>
</ul>
</body>
</html>